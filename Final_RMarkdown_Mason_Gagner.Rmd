---
title: "Mortality Rates Compared Between Vaccinated and Unvaccinated Infants"
author: "Mason Gagner"
date: "`r Sys.Date()`"
output:
  github_document:
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# ABSTRACT

<!--Fill in abstract at the end after we have finished the methods, results, discussion, conclusions and know what our data "says".-->
Infant mortality rate (IMR) serves as a key indicator of population health and long-term societal progress. This study compares historical IMR trends between vaccinated and unvaccinated populations from 1974–2024 to evaluate whether vaccines significantly contribute to greater reductions in infant mortality. A visual comparison of mortality trajectories over time and a linear regression model assessing the rate of decline for each group were performed as project analyses. Both groups showed decreasing IMR across the data's 50-year period, consistent with global advancements in healthcare, sanitation, and living standards. Regression results demonstrated that the vaccinated group experienced a significantly steeper decline in mortality, supported by an lm() model in R yielding a p-value of 2.2e-16. These findings indicate that vaccination is strongly associated with increased reductions of infant mortality and highlight the long-term population-level benefits of immunization programs.

# BACKGROUND

<!--Fill in some text here that provides background info on the WNV system, the blood meal DNA extractions, PCR, sequencing, etc. and the foundation for our question/hypothesis.

NOTE: Examples of data you can plot for the background info at https://github.com/saarman/BIOL3070/ -->
<!--Infant mortality stands as a key indicator of a nation’s overall health and development. Many factors can contribute to the health and life expectancy of people, such as hygiene driven by cultural and technological norms and advancement. Introduction of global vaccination initiatives such as the Expanded Programme on Immunization (EPI) in 1974 has been linked to reductions in preventable childhood deaths (World Health Organization). While there are many studies to confirm the efficacy of vaccines, long-term impact is determined by comparing historical trends of mortality rates.-->
Infant mortality stands as a key indicator of a nation’s overall health and development. Many factors contribute to early-life survival, including access to healthcare, hygiene practices driven by cultural and technological norms, and overall medical advancement (G.L. Drevenstedt et al. 2008). One major global effort to improve child survival has been the introduction of widespread vaccination programs. The Expanded Programme on Immunization (EPI), launched by the World Health Organization in 1974, aimed to reduce preventable childhood deaths by increasing access to vaccines worldwide (World Health Organization).

While the effectiveness of vaccines at preventing specific diseases is well established, the long-term population-level impact is best understood by examining historical trends in infant mortality rates. IMR generally reflects deaths per 1,000 live births and provides a broad picture of overall living conditions. By comparing mortality rates for vaccinated and unvaccinated populations over time we can evaluate how strongly vaccination contributes to declines in infant deaths on a global scale.

# STUDY QUESTION and HYPOTHESIS

## Question  
<!--Fill in here, the question we want to answer... e.g. What bird species is acting as WNV amplifying host in Salt Lake City?-->
Between vaccinated and non-vaccinated groups, who shows a more significant decline in child mortality rates?

## Hypothesis 
<!--Fill in hypothesis... e.g. House finches are acting as important amplifying hosts of WNV in Salt Lake City.-->
Infants that are vaccinated will show a more significant decline in mortality rates compared to those who are unvaccinated.

## Prediction
<!--Fill in prediction... e.g. If house finches are acting as important amplifying hosts, we predict that trapping locations where mosquitoes feed on house finches will also have higher rates of confirmed WNV in tested mosquito pools.-->
If vaccines are effective at reducing mortality rates in infants, we will see a more significant decline in the mortality for those who are vaccinated compared to not.

# METHODS
<!--Fill in here, including overview of procedure and methods used for this project.
-->
Original data came from WHO data bases containing information from major regions such as African, Eastern Mediterranean, European, Americas, South-East Asia, and the Western Pacific. This is a correlation study so the differences between the groups was compared. From the reported data, two analyses were performed to evaluate the significance of vaccination on IMR. The first analysis provides a visual assessment of the raw data for both groups across time. Trends are easily visible using the 1974-2024 data, and the overall difference between the two groups is established.

The second analysis uses a linear regression model to quantify the rate of change in mortality for each group. Separate regression models were fit to the vaccinated and unvaccinated data to calculate their respective slopes. The calculated slopes represent the year over year trend. Because our main question focuses on whether the decline in mortality is significantly different between groups, an interaction model was used to statistically compare the slopes. A p-value threshold of α = 0.05 generally offers statistical significance, where the experimental calculated value fit well within that threshold.

## First Analysis

### Comparing Infant Mortality Rates: Line Graph

```{r linear.plot,fig.align='left',fig.width=10,fig.height=7, warning=FALSE}
library(ggplot2)
library(tidyr)

data <- read.csv("Globalinfantmortalityrate.csv")

# Change the formatting for graph type
data_long <- pivot_longer(data,
                          cols = c("Vaccinated.Mortality.Rate", "Unvaccinated.Mortality.Rate"),
                          names_to = "Group",
                          values_to = "MortalityRate")

# Creating the plot
ggplot(data_long, aes(x = Year, y = MortalityRate, color = Group)) +
  geom_line(size = 1.2) +
  geom_point(size = 2) +
  
  # Solid Axis Lines and line spacing
  geom_hline(yintercept = 0, color = "black", size = 0.6) +
  geom_vline(xintercept = min(data_long$Year), color = "black", size = 0.6) +
  
  scale_y_continuous(
    limits = c(0, 11),
    breaks = seq(0, 11, by = 0.5),   
    minor_breaks = NULL              
  ) +
  scale_x_continuous(
    breaks = seq(min(data_long$Year), max(data_long$Year), by = 10),  
    minor_breaks = data_long$Year                                     
  ) +
  
  # Line colors for the faded/more solid colored lines: AI used to assist in formatting.
  theme_minimal(base_size = 12) +
  theme(
    panel.grid.minor = element_line(color = "gray90", size = 0.2),
    panel.grid.major = element_line(color = "gray70", size = 0.4),   
    panel.border = element_blank(),                                  
    axis.line = element_blank()                                      
  ) +
  
  labs(
    title = "Global Infant Mortality Rate (Vaccinated vs Unvaccinated, 1974–2024)",
    x = "Year",
    y = "Mortality Rate (%)",
    color = "Group"
  )
```

## Second Analysis

### Linear Regression of Vaccinated compared to Unvaccinated

```{r}
data <- read.csv("Globalinfantmortalityrate.csv")

# Slope for Vaccinated
model_vax <- lm(Vaccinated.Mortality.Rate ~ Year, data = data)

# Slope for Unvaccinated
model_unvax <- lm(Unvaccinated.Mortality.Rate ~ Year, data = data)

summary(model_vax)$coefficients
summary(model_unvax)$coefficients

slope_vax <- coef(model_vax)[2]
slope_unvax <- coef(model_unvax)[2]

cat("Vaccinated slope:", slope_vax, "\n")
cat("Unvaccinated slope:", slope_unvax, "\n")

#If the p-value for that term is < 0.05, the slopes are significantly different.
#If the p-value is > 0.05, the slopes are not significantly different.

# Reshape the data
data_long <- data.frame(
  Year = rep(data$Year, 2),
  Mortality = c(data$Vaccinated.Mortality.Rate, data$Unvaccinated.Mortality.Rate),
  Group = rep(c("Vaccinated", "Unvaccinated"), each = nrow(data))
)
model <- lm(Mortality ~ Year * Group, data = data_long)
summary(model)
```

```{r mortality_plot, fig.width=12, fig.height=6, warning=FALSE}

library(ggplot2)
library(dplyr)

# Calculate slope and intercept for each group
equations <- data_long %>%
  group_by(Group) %>%
  do(model = lm(Mortality ~ Year, data = .)) %>%
  summarize(
    Group,
    Intercept = coef(model)[1],
    Slope = coef(model)[2]
  )

# Clean up group names and make equation labels
equations <- equations %>%
  mutate(
    Group = recode(Group,
                   "Vaccinated.Mortality.Rate" = "Vaccinated",
                   "Unvaccinated.Mortality.Rate" = "Unvaccinated"),
    label = paste0(Group, " (y = ",
                   round(Slope, 3), "x + ",
                   round(Intercept, 2), ")")
  )

# Merge labels back into main dataset
data_long_labeled <- data_long %>%
  left_join(equations, by = "Group")

# Plot design: AI was used to assist in the incorporation of the slope onto the graph. 
ggplot(data_long_labeled, aes(x = Year, y = Mortality, color = label)) +
  geom_point(size = 2) +
  geom_smooth(method = "lm", se = FALSE, lwd = 1.2) +
  theme_minimal(base_size = 12) +
  theme(
    plot.title = element_text(hjust = 0.5)  # centers the title
  ) +
  labs(
    title = "Comparison of Mortality Rate Trends Over Time",
    y = "Mortality Rate (%)",
    x = "Year",
    color = "Group Regression Equation"
  )
```

## Results

Very strong statistical difference detected between the two groups: 

Vaccinated Slope: -0.150

Unvaccinated Slope: -0.115

P-Value: 2.2e-16

# DISCUSSION
Data collected and analysed in this study supports the original study hypothesis of infants that are vaccinated will show a more significant decline in mortality rates compared to those who are unvaccinated. Graphical representation and linear regression analyses showed strong statistical difference between the two groups. Findings of this study align with the overall purpose of vaccines which is to protect against future infections, minimizing the risk of fatal sicknesses. 

Limitations of this study can include but are not limited to lack of general demographics where this data is broken down regionally, living conditions, cost of access to healthcare, types of vaccines, and what specifically defines vaccinated or unvaccinated whether it be fully vaccinated or partially. More specific breakdowns of gathered data would be more representative.

## Interpretation - First Analysis
This representation of the data (Shattock et al. 2024) provides a clear visual of the long term historical trends of mortality rate. It is clearly visible that both groups in the study experienced a decrease in overall mortality rate. The decline can be attributed to the overall increase in living conditions and standards. Progression in hygiene and health are applicable to both groups, so assesing the difference between the changes is necessary to understanding the significance, if any, of the impact of vaccines. 

## Interpretation - Second Analysis
Using the slopes of the lines allows for a statistical analysis to be performed. The unvaccinated line had a slope of -0.11 where vaccinated was -0.15. While improvement for both is good, running a t-test for two slopes allows for statistical significance to be determined. Using the lm() function in R, the two regression lines were compared and a p-value of 2.2e-16 was generated. With the standard scientifically accepted p-value of significance being p < 0.05, the data suggests that there is a rather significant difference in the slopes from the two groups. 

# CONCLUSION
The data from this study demonstrates that there is a statistical significance in Infant Mortality Rates between vaccinated and unvaccinated groups, with those who are vaccinated experiencing a much lower rate. Visual representation as well as linear regression analyses indicate the significance of vaccines in preventing infant deaths. Results of the study justify an important look at vaccines and how they can be implemented on a broader scale being made more available for those who do not have them.

# REFERENCES     
G.L. Drevenstedt, E.M. Crimmins, S. Vasunilashorn, & C.E. Finch, The rise and fall of excess male infant mortality, Proc. Natl. Acad. Sci. U.S.A. 105 (13) 5016-5021, https://doi.org/10.1073/pnas.0800221105 (2008).

OpenAI. (2025). ChatGPT (Oct 2025 version) [Large language model]. OpenAI. https://chat.openai.com/ (Used for general structuring and grammatical checking)

Shattock et al. (2024). Contribution of vaccination to improved survival and health: modelling 50 years of the Expanded Programme on Immunization. – processed by Our World in Data. “Global infant mortality rate with and without vaccines” [dataset]. Shattock et al. (2024). Contribution of vaccination to improved survival and health: modelling 50 years of the Expanded Programme on Immunization., “infant_mortality_vaccination_shattock” [original data]. Retrieved October 28, 2025 from https://archive.ourworldindata.org/20250909-093708/grapher/infant-mortality-vaccines.html (archived on September 9, 2025).

World Health Organization. (n.d.). Essential Programme on immunization. World Health Organization. https://www.who.int/teams/immunization-vaccines-and-biologicals/essential-programme-on-immunization 